{
  "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
  "handler": "Microsoft.Azure.CreateUIDef",
  "version": "0.1.2-preview",
  "parameters": {
    "config": {
      "isWizard": true,
      "basics": {
        "location": {
          "toolTip": "Region in which Vendor VNF will be created.",
          "allowedValues": [
            "eastus"
          ]
        }
      }
    },
    "basics": [
      {
        "name": "deviceId",
        "type": "Microsoft.Solutions.ResourceSelector",
        "label": "Azure VNF Manager device",
        "toolTip": "Select the Azure Network Function Manager device on which Vendor VNF will be deployed",
        "resourceType": "Microsoft.HybridNetwork/devices",
        "options": {
          "filter": {
            "subscription": "onBasics",
            "location": "onBasics"
          }
        }
      },
      {
        "name": "nfName",
        "type": "Microsoft.Common.TextBox",
        "label": "NetFoundry VNF Name",
        "placeholder": "demoZiti01",
        "constraints": {
          "required": true
        }
      },
      {
        "name": "edgeRouterKey",
        "label": "Edge Router Registration Key",
        "type": "Microsoft.Common.TextBox",
        "toolTip": "Edge router Registration Key",
        "constraints": {
          "required": true
        }
      },
      {
        "name": "endpointJWT",
        "label": "Endpoint JWT",
        "type": "Microsoft.Common.TextBox",
        "toolTip": "Endpoint JWT Key",
        "constraints": {
          "required": true
        }
      }
    ],
    "steps": [
      {
        "bladeTitle": "Network settings",
        "label": "Network settings",
        "name": "Network Settings",
        "subLabel": {
          "preValidation": "Configure Network Settings",
          "postValidation": "Done"
        },
        "elements": [
          {
            "name": "Management",
            "type": "Microsoft.Common.Section",
            "label": "Management",
            "elements": [
              {
                "name": "ipAddress",
                "label": "IP address",
                "type": "Microsoft.Common.TextBox",
                "toolTip": "Statically assigned IP address for the management interface",
                "placeholder": "192.168.0.x",
                "constraints": {
                  "regex": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$",
                  "validationMessage": "Value must be an IPv4 address.",
                  "required": true
                }
              },
              {
                "name": "subnet",
                "label": "Subnet",
                "type": "Microsoft.Common.TextBox",
                "toolTip": "IP subnet for the interface",
                "placeholder": "192.168.0.x/24",
                "constraints": {
                  "regex": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])/(8|9|[1-2][0-9]|3[0-2])$",
                  "validationMessage": "Value must be an IPv4 subnet.",
                  "required": true
                }
              },
              {
                "name": "gateway",
                "label": "Default gateway",
                "type": "Microsoft.Common.TextBox",
                "toolTip": "Default gateway for the subnet",
                "placeholder": "192.168.0.x",
                "constraints": {
                  "regex": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$",
                  "validationMessage": "Value must be an IPv4 address.",
                  "required": true
                }
              },
              {
                "name": "dnsServer1",
                "type": "Microsoft.Common.TextBox",
                "label": "DNS 1",
                "placeholder": "1.1.1.1"
              },
              {
                "name": "dnsServer2",
                "type": "Microsoft.Common.TextBox",
                "label": "DNS 2"
              }
            ]
          },
          {
            "name": "Lan",
            "type": "Microsoft.Common.Section",
            "label": "Lan",
            "elements": [
              {
                "name": "ipAddress",
                "label": "IP address",
                "type": "Microsoft.Common.TextBox",
                "toolTip": "Statically assigned IP address for the lan interface",
                "placeholder": "192.168.0.x",
                "constraints": {
                  "regex": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$",
                  "validationMessage": "Value must be an IPv4 address.",
                  "required": true
                }
              },
              {
                "name": "subnet",
                "label": "Subnet",
                "type": "Microsoft.Common.TextBox",
                "toolTip": "IP subnet for the interface",
                "placeholder": "192.168.0.x/24",
                "constraints": {
                  "regex": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])/(8|9|[1-2][0-9]|3[0-2])$",
                  "validationMessage": "Value must be an IPv4 subnet.",
                  "required": true
                }
              },
              {
                "name": "gateway",
                "label": "Default gateway",
                "type": "Microsoft.Common.TextBox",
                "toolTip": "Default gateway for the subnet",
                "placeholder": "192.168.0.x",
                "constraints": {
                  "regex": "^(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\\.){3}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$",
                  "validationMessage": "Value must be an IPv4 address."
                }
              }
            ]
          }
        ]
      }
    ],
    "outputs": {
      "location": "[location()]",
      "nfName": "[basics('nfName')]",
      "deviceId": "[basics('deviceId').id]",
      "edgeRouterKey": "[basics('edgeRouterKey')]",
      "endpointJWT": "[basics('endpointJWT')]",
      "mecmgmtNic": {
        "vmSwitchType": "Management",
        "ipAddress": "[steps('Network Settings').Management.ipAddress]",
        "subnet": "[steps('Network Settings').Management.subnet]",
        "gateway": "[steps('Network Settings').Management.gateway]",
        "dnsServer1": "[steps('Network Settings').Management.dnsServer1]",
        "dnsServer2": "[steps('Network Settings').Management.dnsServer2]"
      },
      "meclanNic": {
        "vmSwitchType": "Lan",
        "ipAddress": "[steps('Network Settings').Lan.ipAddress]",
        "subnet": "[steps('Network Settings').Lan.subnet]",
        "gateway": "[steps('Network Settings').Lan.gateway]",
        "dnsServer1": "[steps('Network Settings').Lan.dnsServer1]",
        "dnsServer2": "[steps('Network Settings').Lan.dnsServer2]"
      }
    }
  }
}
